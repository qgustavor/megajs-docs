"use strict";(self.webpackChunkmegajs_docs=self.webpackChunkmegajs_docs||[]).push([[4257],{1716:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>p,contentTitle:()=>l,default:()=>c,frontMatter:()=>s,metadata:()=>d,toc:()=>u});var t=a(4848),o=a(8453),i=a(1432);const r="import { getLoggedInStorage } from './logging-in-demo.js'\nconst storage = await getLoggedInStorage()\n\n// Open the file to be read\nconst name = prompt('Enter a file name:')\nconst denoFile = await Deno.open(name)\n\nconst uploadStream = storage.upload({ name })\n\n// Get the file reader\nconst inputReader = denoFile.readable.getReader()\n\n// Read the file and pass the data to the upload stream\n// (it's a Node.js Writable stream)\nwhile (true) {\n  const result = await inputReader.read()\n\n  if (result.value) {\n    const canContinueWritting = uploadStream.write(result.value)\n    if (!canContinueWritting) {\n      // Upload stream is under pressure, wait it to drain\n      await new Promise(resolve => uploadStream.once('drain', resolve))\n    }\n  }\n  \n  if (result.done) {\n    // End the stream when there is no more data to be read\n    uploadStream.end()\n\n    // And break out the while loop\n    break\n  }\n}\n\n// Wait for the upload to complete and get the new file object\nconst file = await uploadStream.complete\nconsole.log('The file was uploaded!', file)\n",s={sidebar_position:2.012},l="File uploading while streaming",d={id:"examples/file-uploading-stream",title:"File uploading while streaming",description:"You can try by running this code at your console:",source:"@site/docs/examples/file-uploading-stream.md",sourceDirName:"examples",slug:"/examples/file-uploading-stream",permalink:"/docs/1.0/examples/file-uploading-stream",draft:!1,unlisted:!1,editUrl:"https://github.com/qgustavor/megajs-docs/tree/main/docs/examples/file-uploading-stream.md",tags:[],version:"current",sidebarPosition:2.012,frontMatter:{sidebar_position:2.012},sidebar:"tutorialSidebar",previous:{title:"Recursive streamed folder uploading",permalink:"/docs/1.0/examples/advanced-folder-uploading"},next:{title:"File downloading while streaming",permalink:"/docs/1.0/examples/file-streaming"}},p={},u=[];function m(e){const n={code:"code",h1:"h1",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"file-uploading-while-streaming",children:"File uploading while streaming"}),"\n",(0,t.jsx)(n.p,{children:"You can try by running this code at your console:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"deno run https://mega.js.org/demos/uploading-stream-demo.js\n"})}),"\n","\n",(0,t.jsx)(i.A,{language:"js",children:r})]})}function c(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(m,{...e})}):m(e)}}}]);