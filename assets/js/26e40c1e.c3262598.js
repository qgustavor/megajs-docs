"use strict";(self.webpackChunkmegajs_docs=self.webpackChunkmegajs_docs||[]).push([[773],{1348:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>d,toc:()=>u});var o=r(4848),t=r(8453),a=r(2267);const l="import { File } from 'megajs'\n\n// Get the file object from the URL\nconst file = File.fromURL('https://mega.nz/file/example#example')\n\n// Load file attributes\nfile.loadAttributes(error => {\n  if (error) return console.error(error)\n\n  // Then finally download the file like usual\n  file.download((error, data) => {\n    if (error) return console.error(error)\n    console.log(data)\n  })\n})\n",s={sidebar_position:6},i="Downloading files",d={id:"tutorial/downloading",title:"Downloading files",description:"To share a download you call .download() on the file object:",source:"@site/versioned_docs/version-0.17/tutorial/downloading.md",sourceDirName:"tutorial",slug:"/tutorial/downloading",permalink:"/docs/0.17/tutorial/downloading",draft:!1,unlisted:!1,editUrl:"https://github.com/qgustavor/megajs-docs/tree/main/versioned_docs/version-0.17/tutorial/downloading.md",tags:[],version:"0.17",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Handling files",permalink:"/docs/0.17/tutorial/handling-files"},next:{title:"Advanced usage",permalink:"/docs/0.17/tutorial/advanced"}},c={},u=[];function f(e){const n={a:"a",code:"code",h1:"h1",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"downloading-files",children:"Downloading files"}),"\n",(0,o.jsxs)(n.p,{children:["To share a download you call ",(0,o.jsx)(n.code,{children:".download()"})," on the file object:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"file.download((error, data) => {\n  if (error) console.error(error)\n\n  // data is a Buffer containing the file contents\n  console.log(data)\n})\n"})}),"\n",(0,o.jsx)(n.p,{children:"You can also download files using Node streams either via pipes..."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const stream = file.download()\nstream.on('error', error => console.error(error))\nstream.pipe(fs.createWriteStream(file.name))\n"})}),"\n",(0,o.jsx)(n.p,{children:"... or by listening data events:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const stream = file.download()\nstream.on('error', error => console.error(error))\nstream.on('data', data => console.log(data))\n"})}),"\n",(0,o.jsxs)(n.p,{children:["You can get progress events from the ",(0,o.jsx)(n.code,{children:"progress"})," event like this:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"const stream = file.download()\nstream.on('progress', info => {\n  console.log('Loaded', info.bytesLoaded, 'bytes of', info.bytesTotal)\n})\n"})}),"\n",(0,o.jsxs)(n.p,{children:["In order to render the values returned by the ",(0,o.jsx)(n.code,{children:"progress"})," event you can use libraries such as ",(0,o.jsx)(n.a,{href:"https://www.npmjs.com/package/cli-progress",children:"cli-progress"})," and ",(0,o.jsx)(n.a,{href:"https://www.npmjs.com/package/progress",children:"progress"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"You can download shared files by loading those from their URL instead of loading from the Storage class:"}),"\n","\n",(0,o.jsx)(a.A,{language:"js",code:l}),"\n",(0,o.jsxs)(n.p,{children:["Shared files loaded using ",(0,o.jsx)(n.code,{children:"File.fromURL"})," don't have attributes - such as name and size - loaded by default, that's why ",(0,o.jsx)(n.code,{children:"loadAttributes"})," is called. If you don't need those data, just file contents, you can download the file directly using ",(0,o.jsx)(n.code,{children:".download()"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["Shared folders can also be loaded using ",(0,o.jsx)(n.code,{children:"File.fromURL"})," and will behave like folders in ",(0,o.jsx)(n.code,{children:"Storage"}),": once their attributes are loaded they will have a ",(0,o.jsx)(n.code,{children:".children"})," property with an array of File objects which can be downloaded."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"// Get the folder object from the URL\nconst folder = File.fromURL('https://mega.nz/folder/example#example')\n\n// Load folder attributes\nfolder.loadAttributes(error => {\n  if (error) return console.error(error)\n\n  // Download a file from the folder\n  folder.children.find(file => file.name === 'hello-world.txt').download((error, data) => {\n    if (error) return console.error(error)\n    console.log(data)\n  })\n})\n"})}),"\n",(0,o.jsxs)(n.p,{children:["When opening shared folders in MEGA you can right-click some file and get a file pointing to a specific file in the folder. This library recognizes those kind of links and allow loading the file specified. To make it work get the file from the second argument in the ",(0,o.jsx)(n.code,{children:"loadAttributes"})," callback, like this:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"// Get the folder object from the URL\nconst folder = File.fromURL('https://mega.nz/folder/example#example/file/example')\n\n// Load folder attributes\nfolder.loadAttributes((error, file) => {\n  if (error) return console.error(error)\n\n  // Will download a file specified by /file/example in the URL\n  file.download((error, data) => {\n    if (error) return console.error(error)\n    console.log(data)\n  })\n})\n"})}),"\n",(0,o.jsx)(n.p,{children:"And that's the end of the tutorial. At least the basic part: next comes some info on advanced usage."})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(f,{...e})}):f(e)}},9365:(e,n,r)=>{r.d(n,{A:()=>l});r(6540);var o=r(4164);const t={tabItem:"tabItem_Ymn6"};var a=r(4848);function l(e){let{children:n,hidden:r,className:l}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,o.A)(t.tabItem,l),hidden:r,children:n})}},1470:(e,n,r)=>{r.d(n,{A:()=>y});var o=r(6540),t=r(4164),a=r(3104),l=r(6347),s=r(205),i=r(7485),d=r(1682),c=r(9466);function u(e){return o.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,o.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function f(e){const{values:n,children:r}=e;return(0,o.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:r,attributes:o,default:t}}=e;return{value:n,label:r,attributes:o,default:t}}))}(r);return function(e){const n=(0,d.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,r])}function h(e){let{value:n,tabValues:r}=e;return r.some((e=>e.value===n))}function p(e){let{queryString:n=!1,groupId:r}=e;const t=(0,l.W6)(),a=function(e){let{queryString:n=!1,groupId:r}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:n,groupId:r});return[(0,i.aZ)(a),(0,o.useCallback)((e=>{if(!a)return;const n=new URLSearchParams(t.location.search);n.set(a,e),t.replace({...t.location,search:n.toString()})}),[a,t])]}function m(e){const{defaultValue:n,queryString:r=!1,groupId:t}=e,a=f(e),[l,i]=(0,o.useState)((()=>function(e){let{defaultValue:n,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!h({value:n,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const o=r.find((e=>e.default))??r[0];if(!o)throw new Error("Unexpected error: 0 tabValues");return o.value}({defaultValue:n,tabValues:a}))),[d,u]=p({queryString:r,groupId:t}),[m,g]=function(e){let{groupId:n}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(n),[t,a]=(0,c.Dv)(r);return[t,(0,o.useCallback)((e=>{r&&a.set(e)}),[r,a])]}({groupId:t}),b=(()=>{const e=d??m;return h({value:e,tabValues:a})?e:null})();(0,s.A)((()=>{b&&i(b)}),[b]);return{selectedValue:l,selectValue:(0,o.useCallback)((e=>{if(!h({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);i(e),u(e),g(e)}),[u,g,a]),tabValues:a}}var g=r(2303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var j=r(4848);function v(e){let{className:n,block:r,selectedValue:o,selectValue:l,tabValues:s}=e;const i=[],{blockElementScrollPositionUntilNextRender:d}=(0,a.a_)(),c=e=>{const n=e.currentTarget,r=i.indexOf(n),t=s[r].value;t!==o&&(d(n),l(t))},u=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const r=i.indexOf(e.currentTarget)+1;n=i[r]??i[0];break}case"ArrowLeft":{const r=i.indexOf(e.currentTarget)-1;n=i[r]??i[i.length-1];break}}n?.focus()};return(0,j.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":r},n),children:s.map((e=>{let{value:n,label:r,attributes:a}=e;return(0,j.jsx)("li",{role:"tab",tabIndex:o===n?0:-1,"aria-selected":o===n,ref:e=>i.push(e),onKeyDown:u,onClick:c,...a,className:(0,t.A)("tabs__item",b.tabItem,a?.className,{"tabs__item--active":o===n}),children:r??n},n)}))})}function x(e){let{lazy:n,children:r,selectedValue:t}=e;const a=(Array.isArray(r)?r:[r]).filter(Boolean);if(n){const e=a.find((e=>e.props.value===t));return e?(0,o.cloneElement)(e,{className:"margin-top--md"}):null}return(0,j.jsx)("div",{className:"margin-top--md",children:a.map(((e,n)=>(0,o.cloneElement)(e,{key:n,hidden:e.props.value!==t})))})}function w(e){const n=m(e);return(0,j.jsxs)("div",{className:(0,t.A)("tabs-container",b.tabList),children:[(0,j.jsx)(v,{...e,...n}),(0,j.jsx)(x,{...e,...n})]})}function y(e){const n=(0,g.A)();return(0,j.jsx)(w,{...e,children:u(e.children)},String(n))}},2267:(e,n,r)=>{r.d(n,{A:()=>d});r(6540);var o=r(1432),t=r(1470),a=r(9365);r(4586);const l=["Node ESM","Node CJS","Browser","Deno"],s=[e=>e.replace(/\/\/ node2deno:if-deno\n.*\n?/g,"").replace(/\/\/ node2deno:if-node\n/g,""),e=>((e=e.replace(/\/\/ node2deno:if-deno\n.*\n?/g,"").replace(/\/\/ node2deno:if-node\n/g,"")).includes("await ")&&(e=e.replace(/^(?!import|$)/gm,"  ").replace(/^\s*$/m,"\n// Node doesn't support top-level await when using CJS\n;(async function () {").replace(/\n*$/,"\n}()).catch(error => {\n  console.error(error)\n  process.exit(1)\n})\n")),e=e.replace(/import (.+?) from 'megajs'/g,"const $1 = require('megajs')")),e=>e.replace(/import (.+?) from 'megajs'/g,"import $1 from 'https://cdn.skypack.dev/megajs'").replace(/\/\/ node2deno:if-node\n.*\n/g,"").replace(/\/\/ node2deno:if-deno\n/g,""),e=>e.replace(/import (.+?) from 'megajs'/g,"import $1 from 'npm:megajs'").replace(/\/\/ node2deno:if-node\n.*\n/g,"").replace(/\/\/ node2deno:if-deno\n/g,"")];var i=r(4848);function d(e){null==e.version||1===Number(e.version)||e.version;return(0,i.jsx)("div",{children:(0,i.jsx)(t.A,{groupId:"node2deno",className:"margin-bottom--sm",children:l.map(((n,r)=>(0,i.jsx)(a.A,{value:r,label:n,onClick:()=>setMode(r),children:(0,i.jsx)(o.A,{language:e.language,children:s[r](e.code)})},"+"+r)))})})}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>s});var o=r(6540);const t={},a=o.createContext(t);function l(e){const n=o.useContext(a);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),o.createElement(a.Provider,{value:n},e.children)}}}]);