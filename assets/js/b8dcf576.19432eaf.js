"use strict";(self.webpackChunkmegajs_docs=self.webpackChunkmegajs_docs||[]).push([[978],{1648:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>r,default:()=>c,frontMatter:()=>a,metadata:()=>i,toc:()=>d});var l=t(7462),o=(t(7294),t(3905));const a={sidebar_position:5},r="Handling files",i={unversionedId:"tutorial/handling-files",id:"tutorial/handling-files",title:"Handling files",description:"To share a file you call .link() on the file object you got when uploading:",source:"@site/docs/tutorial/handling-files.md",sourceDirName:"tutorial",slug:"/tutorial/handling-files",permalink:"/docs/1.0/tutorial/handling-files",draft:!1,editUrl:"https://github.com/qgustavor/megajs-docs/tree/main/docs/tutorial/handling-files.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Uploading files",permalink:"/docs/1.0/tutorial/uploading"},next:{title:"Downloading files",permalink:"/docs/1.0/tutorial/downloading"}},s={},d=[],f={toc:d},h="wrapper";function c(e){let{components:n,...t}=e;return(0,o.kt)(h,(0,l.Z)({},f,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"handling-files"},"Handling files"),(0,o.kt)("p",null,"To share a file you call ",(0,o.kt)("inlineCode",{parentName:"p"},".link()")," on the file object you got when uploading:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// Using promises\nconst link = await file.link()\n\n// It will log something like https://mega.nz/file/example#example\nconsole.log(link)\n\n// Using callbacks\nfile.link((error, link) => {\n  if (error) console.error(error)\n  console.log(link)\n})\n")),(0,o.kt)("p",null,"You can also share files in your account like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// storage is the new Storage() class from the login tutorial\n\n// It will share the first file in the root folder of the account \nstorage.root.children[0].link()\n")),(0,o.kt)("p",null,"To access files in Storage class you can use ",(0,o.kt)("inlineCode",{parentName:"p"},".root")," to access the root folder then ",(0,o.kt)("inlineCode",{parentName:"p"},".children")," to list its children, which are also ",(0,o.kt)("inlineCode",{parentName:"p"},"File")," objects."),(0,o.kt)("p",null,"If you need to find a file from a folder by the name you can use ",(0,o.kt)("inlineCode",{parentName:"p"},"Array.prototype.find")," (or other array methods) on the ",(0,o.kt)("inlineCode",{parentName:"p"},".children")," property:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const file = storage.root.children.find(file => file.name === 'hello-world.txt')\n\nstorage.root.children.find(file => file.name === 'hello-world.txt') // Returns the hello-world.txt file from the storage root\nstorage.root.children.find(folder => folder.name === 'My Folder') // Returns the \"My Folder\" directory from the storage root\nstorage.root.children.filter(file => file.name.match(/\\.jpe?g$/i)) // Returns all .jpeg and .jpg files from the storage root\n")),(0,o.kt)("p",null,"Because of AI chat tools (like Gemini or Copilot) which constantly hallucinated unexistent methods, a ",(0,o.kt)("inlineCode",{parentName:"p"},"storage.find")," helper method, originally an AI hallucination, was created in version 1.2.0:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// Both examples searches files named \"hello-world.txt\"\nstorage.find('hello-world.txt')\nstorage.find(file => file.name === 'hello-world.txt')\n\n// Returns the first .jpeg or .jpg file from the storage root\nstorage.find(file => file.name.match(/\\.jpe?g$/i))\n\n// Set the second parameter to true to make it search recursively\nstorage.find('hello-world.txt', true)\n\n// You can call it in any folder:\nstorage.find('some folder').find('some other folder').find('some file.txt')\n")),(0,o.kt)("p",null,"Version 1.2.0 also introduced the ",(0,o.kt)("inlineCode",{parentName:"p"},".navigate")," method in order to make deep navigation easier, without needed to chain ",(0,o.kt)("inlineCode",{parentName:"p"},".find")," calls like above:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// Works like the above example:\nstorage.navigate('some folder/some other folder/some file.txt')\n\n// If a file or folder in the navigation chain doesn't exist the entire function returns undefined.\nstorage.navigate('an unexistent folder/an unexistent file.txt') // undefined\n\n// If you have files or folders with \"/\" in the name, you can use an array as input:\nstorage.navigate(['some folder', 'a weird folder with / in the name', 'some file.txt'])\n\n// You can call it inside folders too:\nstorage.find('some folder').navigate('some other folder/some file.txt')\n")),(0,o.kt)("p",null,"The function ",(0,o.kt)("inlineCode",{parentName:"p"},".filter"),", also introduced in version 1.2.0, works like ",(0,o.kt)("inlineCode",{parentName:"p"},".find"),", but returns an array with files matching the query instead of the first match:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// Both examples returns an array with all files files named \"hello-world.txt\" in the directory root\nstorage.filter('hello-world.txt')\nstorage.filter(file => file.name === 'hello-world.txt')\n\n// It's useful when using a function as a query:\n// Returns all .jpeg and .jpg files from the storage root\nstorage.filter(file => file.name.match(/\\.jpe?g$/i))\n\n// Set the second parameter to true to make it search recursively\n// Returns all files named \"hello-world.txt\" in the entire storage\nstorage.filter('hello-world.txt', true)\n\n// Returns all files larger than 1024 bytes from entire storage\nstorage.filter(file => file.size > 1024, true)\n\n// You can call it on a folder too\n// Returns all files larger than 1024 bytes inside \"some folder\"\nstorage.find('some folder').filter(file => file.size > 1024, true)\n")),(0,o.kt)("p",null,"Folders are also listed in ",(0,o.kt)("inlineCode",{parentName:"p"},"storage.files")," and in ",(0,o.kt)("inlineCode",{parentName:"p"},".children"),", as folders are also ",(0,o.kt)("inlineCode",{parentName:"p"},"File")," objects, the difference being that they have ",(0,o.kt)("inlineCode",{parentName:"p"},".directory")," set to ",(0,o.kt)("inlineCode",{parentName:"p"},"true"),", have ",(0,o.kt)("inlineCode",{parentName:"p"},".children")," defined to be an array of its children and cannot be downloaded."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// How to get the file \"hello-world.txt\" inside the file \"My Folder\" from the storage root:\n\n// --- Before v1.2.0\nstorage.root.children.find(folder => folder.name === 'My Folder').children.find(file => file.name === 'hello-world.txt')\n\n// --- After v1.2.0\nstorage.navigate('My Folder/hello-world.txt')\n\n\n// How to search files in the entire storage:\n\n// --- Before v1.2.0, using the `storage.files` object:\nObject.values(storage.files).find(file => file.name === 'hello-world.txt')\n\n// --- After v1.2.0, using `.find` in recursive mode:\nstorage.find('hello-world.txt', true)\n")),(0,o.kt)("p",null,"Folders and files can be manipulated via many methods:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"fileORFolder.link() // shares files and folders\nfileORFolder.unshare() // unshares files and folders\nfileORFolder.rename(newName) // renames files and folders\nfileORFolder.moveTo(someFolder) // moves files and folders\nfileORFolder.setFavorite(true) // marks files and folders as favorites\nfileORFolder.delete() // moves files and folders to the trash\nfileORFolder.delete(true) // delete files and folders permanently \n")),(0,o.kt)("p",null,"Some examples:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// Shares a file\nconst sharedLink = await file.link()\nconsole.log(sharedLink)\n\n// Renames a file\nawait file.rename('A whole new name.txt')\n\n// Moves a file to other directory\nconst otherDirectory = storage.find('Other Directory')\nawait file.moveTo(otherDirectory)\n\n// Moves a file to the trash bin\nawait file.delete()\n\n// Deletes a file permanently\nawait file.delete(true)\n")),(0,o.kt)("p",null,"Those functions return promises and also accept callbacks:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// The first example above using callbacks\nfile.link((error, link) => {\n  if (error) throw error\n  console.log(link)\n})\n")),(0,o.kt)("p",null,"While you cannot download folders, they can upload files on then like you can in the root folder:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"await folder.upload('hello-world.txt', 'Hello World!').complete\n")),(0,o.kt)("p",null,"You can also create new folders:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"// Using promises\nconst folder = await folder.mkdir('New Folder')\nconsole.log(folder)\n\n// Using callbacks\nfolder.mkdir('New Folder', (error, folder) {\n  if (error) console.error(error)\n  console.log(folder)\n})\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"The method ",(0,o.kt)("inlineCode",{parentName:"p"},".createFolder")," ",(0,o.kt)("strong",{parentName:"p"},"does not exist"),": it's an AI hallucination, use ",(0,o.kt)("inlineCode",{parentName:"p"},".mkdir")," instead. The method ",(0,o.kt)("inlineCode",{parentName:"p"},".share")," ",(0,o.kt)("strong",{parentName:"p"},"does not exist"),": it's an AI hallucination, use ",(0,o.kt)("inlineCode",{parentName:"p"},".link")," instead.")),(0,o.kt)("p",null,"The complete list of methods that can be called on files and folders can be found in the API page."),(0,o.kt)("p",null,"In the next part of the tutorial we will learn how to download files from the storage and public shared files."))}c.isMDXComponent=!0}}]);