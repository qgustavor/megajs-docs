"use strict";(self.webpackChunkmegajs_docs=self.webpackChunkmegajs_docs||[]).push([[75],{1584:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>g,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var o=n(7462),a=(n(7294),n(3905)),r=n(1374);const i={sidebar_position:3},s="Logging in",l={unversionedId:"tutorial/login",id:"tutorial/login",title:"Logging in",description:"To log in to an account use the Storage class:",source:"@site/docs/tutorial/login.md",sourceDirName:"tutorial",slug:"/tutorial/login",permalink:"/docs/1.0/tutorial/login",draft:!1,editUrl:"https://github.com/qgustavor/megajs-docs/tree/main/docs/tutorial/login.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Installing",permalink:"/docs/1.0/tutorial/install"},next:{title:"Uploading files",permalink:"/docs/1.0/tutorial/uploading"}},p={},d=[],m={toc:d},u="wrapper";function g(e){let{components:t,...n}=e;return(0,a.kt)(u,(0,o.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"logging-in"},"Logging in"),(0,a.kt)("p",null,"To log in to an account use the ",(0,a.kt)("inlineCode",{parentName:"p"},"Storage")," class:"),(0,a.kt)(r.Z,{language:"js",code:"import { Storage } from 'megajs'\n\nconst storage = new Storage({\n  email: 'user@example.com',\n  password: 'correct horse battery example',\n// node2deno:if-node\n  userAgent: 'ExampleApplication/1.0'\n// node2deno:if-deno\n  userAgent: null\n})\n\n// Will resolve once the user is logged in\n// or reject if some error happens\nawait storage.ready",version:"1",mdxType:"CodeBlockSwitchable"}),(0,a.kt)("p",null,"It is recommended to set up an user-agent. The library will default to ",(0,a.kt)("inlineCode",{parentName:"p"},"megajs/{version}")," (where ",(0,a.kt)("inlineCode",{parentName:"p"},"{version}")," is the library version). When deploying to browsers set ",(0,a.kt)("inlineCode",{parentName:"p"},"userAgent")," to ",(0,a.kt)("inlineCode",{parentName:"p"},"null")," as it can cause issues in some browsers which allow client-side code to override the ",(0,a.kt)("inlineCode",{parentName:"p"},"user-agent")," header (like Firefox)."),(0,a.kt)("p",null,"You can use two-factor authentication, just provide the second factor code like this:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const storage = new Storage({\n  email: 'user@example.com',\n  password: 'correct horse battery example',\n  userAgent: 'ExampleClient/1.0',\n  // highlight-next-line\n  secondFactorCode: '123456'\n})\n")),(0,a.kt)("p",null,"Events can still be used like in V0:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"storage.once('ready', () => {\n  // User is now logged in\n})\n\nstorage.once('error', error => {\n  // Some error happened\n})\n")),(0,a.kt)("p",null,"It may look weird to pass a callback to a constructor, but that's an option too:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const storage = new Storage({\n  email: 'user@example.com',\n  password: 'correct horse battery example',\n  userAgent: 'ExampleClient/1.0'\n}, error => {\n  if (error) {\n    // Some error happened\n  } else {\n    // User is now logged in\n  }\n})\n")),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"If you are migrating from ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/tonistiigi/mega"},"tonistiigi's mega")," you can still use the following code:"),(0,a.kt)("pre",{parentName:"admonition"},(0,a.kt)("code",{parentName:"pre",className:"language-js"},"const mega = require('megajs')\n\nconst storage = mega({\n  email: 'user@example.com',\n  password: 'correct horse battery example'\n}, error => {\n  if (error) {\n    // Some error happened\n  } else {\n    // User is now logged in\n  }\n})\n")),(0,a.kt)("p",{parentName:"admonition"},"But this pattern might not be supported in future versions because it is not compatible with ES modules and causes issues with tree shaking, which is important when this using this library in a browser environment."),(0,a.kt)("p",{parentName:"admonition"},"If you try to import the library using ",(0,a.kt)("inlineCode",{parentName:"p"},"import mega from 'megajs'")," it will throw the following error: ",(0,a.kt)("inlineCode",{parentName:"p"},"SyntaxError: The requested module 'megajs' does not provide an export named 'default'"),". Notice that, at the moment, Visual Studio Code will load CJS types - which still support this pattern - instead of ESM types even when using ",(0,a.kt)("inlineCode",{parentName:"p"},"import")," instead of ",(0,a.kt)("inlineCode",{parentName:"p"},"require")," and, because of that, it will not warn about this issue.")),(0,a.kt)("p",null,"In the next part of this tutorial we will use the ",(0,a.kt)("inlineCode",{parentName:"p"},"storage")," object to upload a file."))}g.isMDXComponent=!0}}]);