"use strict";(self.webpackChunkmegajs_docs=self.webpackChunkmegajs_docs||[]).push([[7624],{8946:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>j,frontMatter:()=>t,metadata:()=>a,toc:()=>h});var s=i(4848),r=i(8453),l=i(1470),o=i(9365);const t={sidebar_position:3},d="API Reference",a={id:"api",title:"API Reference",description:"This library handles MEGA encryption, file and folder handling and networking. Since this is a library focused on work on multiple platforms (Node.js and browsers) it does not and will not handle file reading, file writting nor any platform-specific file operations.",source:"@site/docs/api.md",sourceDirName:".",slug:"/api",permalink:"/docs/1.0/api",draft:!1,unlisted:!1,editUrl:"https://github.com/qgustavor/megajs-docs/tree/main/docs/api.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Folder shared with custom key",permalink:"/docs/1.0/examples/custom-key-folder-share"},next:{title:"Migrating from old versions",permalink:"/docs/1.0/migrating-from-old-versions"}},c={},h=[{value:"Promises",id:"promises",level:2},{value:"Entry point",id:"entry-point",level:2},{value:"Storage",id:"storage",level:2},{value:"Creation",id:"creation",level:3},{value:"Options",id:"options",level:3},{value:"Properties",id:"properties",level:3},{value:"Methods",id:"methods",level:3},{value:"Shorthands",id:"shorthands",level:4},{value:"<code>.reload()</code>",id:"reload",level:4},{value:"<code>.login()</code>",id:"login",level:4},{value:"<code>.getAccountInfo()</code>",id:"getaccountinfo",level:4},{value:"<code>.close()</code>",id:"close",level:4},{value:"Events",id:"events",level:3},{value:"File",id:"file",level:2},{value:"Creation",id:"creation-1",level:3},{value:"Options",id:"options-1",level:3},{value:"Properties",id:"properties-1",level:3},{value:"Methods",id:"methods-1",level:3},{value:"<code>.loadAttributes()</code>",id:"loadattributes",level:4},{value:"<code>.download([options], [callback])</code>",id:"downloadoptions-callback",level:4},{value:"<code>.downloadBuffer([options])</code>",id:"downloadbufferoptions",level:4},{value:"<code>.find(query, [deep])</code>",id:"findquery-deep",level:4},{value:"<code>.filter(query, [deep])</code>",id:"filterquery-deep",level:4},{value:"<code>.navigate(query)</code>",id:"navigatequery",level:4},{value:"Static methods",id:"static-methods",level:3},{value:"<code>File.fromURL(url, [options])</code>",id:"filefromurlurl-options",level:4},{value:"<code>File.defaultHandleRetries(tries, error, cb)</code>",id:"filedefaulthandleretriestries-error-cb",level:4},{value:"Mutable File",id:"mutable-file",level:2},{value:"Basic syntax",id:"basic-syntax",level:3},{value:"Methods",id:"methods-2",level:3},{value:"<code>.upload(options | name, [data], [callback])</code>",id:"uploadoptions--name-data-callback",level:4},{value:"<code>.mkdir(options | name)</code>",id:"mkdiroptions--name",level:4},{value:"<code>.importFile(File | URL)</code>",id:"importfilefile--url",level:4},{value:"<code>.link([options])</code> / <code>.shareFolder([options])</code>",id:"linkoptions--sharefolderoptions",level:4},{value:"<code>.unshare()</code> / <code>.unshareFolder()</code>",id:"unshare--unsharefolder",level:4},{value:"<code>.delete(permanent)</code>",id:"deletepermanent",level:4},{value:"<code>.moveTo(target)</code>",id:"movetotarget",level:4},{value:"<code>.setAttributes(attributes)</code>",id:"setattributesattributes",level:4},{value:"<code>.uploadAttribute(type, [buffer|stream])</code>",id:"uploadattributetype-bufferstream",level:4},{value:"<code>.rename(newFileName)</code>",id:"renamenewfilename",level:4},{value:"<code>.setLabel(label)</code>",id:"setlabellabel",level:4},{value:"<code>.setFavorite(isFavorite)</code>",id:"setfavoriteisfavorite",level:4},{value:"Events",id:"events-1",level:3},{value:"API",id:"api",level:2},{value:"Properties",id:"properties-2",level:3},{value:"Static functions",id:"static-functions",level:3},{value:"<code>API.getGlobalApi()</code>",id:"apigetglobalapi",level:4},{value:"Low level functions",id:"low-level-functions",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"api-reference",children:"API Reference"}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsxs)(n.p,{children:["This library handles MEGA encryption, file and folder handling and networking. Since this is a library focused on work on multiple platforms (Node.js and browsers) ",(0,s.jsx)(n.strong,{children:"it does not and will not"})," handle file reading, file writting nor any platform-specific file operations."]}),(0,s.jsxs)(n.p,{children:["You should implement file I/O using the functions provided by your platform (like reading files using ",(0,s.jsx)(n.code,{children:"fs.createReadStream"})," on Node and ",(0,s.jsx)(n.code,{children:'<input type="file">'})," on browsers, and writting using ",(0,s.jsx)(n.code,{children:"fs.createWriteStream"})," on Node and ",(0,s.jsx)(n.code,{children:"<a download>"})," on browsers)."]})]}),"\n",(0,s.jsx)(n.h2,{id:"promises",children:"Promises"}),"\n",(0,s.jsx)(n.p,{children:"Promise support was added in V1. All functions which used to accept callbacks now also accept promises, except by:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"new Storage()"}),": the promise is available in the ",(0,s.jsx)(n.code,{children:".ready"})," property;"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".upload()"}),": the promise is available in the ",(0,s.jsx)(n.code,{children:".complete"})," property;"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".download()"}),": call ",(0,s.jsx)(n.code,{children:".downloadBuffer()"})," instead;"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"entry-point",children:"Entry point"}),"\n",(0,s.jsx)(n.p,{children:"The exported classes and functions are those below:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Storage"})," class"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"File"})," class"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"file"}),": alias to ",(0,s.jsx)(n.code,{children:"File.fromURL"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"API"})," class"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"encrypt"}),", ",(0,s.jsx)(n.code,{children:"decrypt"})," and ",(0,s.jsx)(n.code,{children:"verify"})," (low level encryption streams)"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"storage",children:"Storage"}),"\n",(0,s.jsx)(n.p,{children:"Creates a logged in connection instance to MEGA."}),"\n",(0,s.jsx)(n.h3,{id:"creation",children:"Creation"}),"\n",(0,s.jsxs)(l.A,{groupId:"node2deno",children:[(0,s.jsx)(o.A,{value:"node_esm",label:"Node ESM",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import { Storage } from 'megajs'\nconst storage = new Storage(options, [callback])\n"})})}),(0,s.jsx)(o.A,{value:"node_cjs",label:"Node CJS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const { Storage } = require('megajs')\nconst storage = new Storage(options, [callback])\n"})})}),(0,s.jsx)(o.A,{value:"browser",label:"Browser",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import { Storage } from 'https://unpkg.com/megajs/dist/main.browser-es.mjs'\nconst storage = new Storage(options, [callback])\n"})})}),(0,s.jsx)(o.A,{value:"deno",label:"Deno",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import { Storage } from 'npm:megajs'\nconst storage = new Storage(options, [callback])\n"})})})]}),"\n",(0,s.jsx)(n.h3,{id:"options",children:"Options"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"email"})," - User login email ",(0,s.jsx)(n.strong,{children:"required"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"password"})," - User password ",(0,s.jsx)(n.strong,{children:"required"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"secondFactorCode"})," - User two-factor authentication code (since 1.2.0)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"keepalive"})," - Keep connection open to receive server-to-client requests that will be mapped to events. Defaults to ",(0,s.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"autologin"})," - Logins to MEGA. Defaults to ",(0,s.jsx)(n.code,{children:"true"}),". Set to ",(0,s.jsx)(n.code,{children:"false"})," if you want to change request options, like proxy, ",(0,s.jsx)(n.a,{href:"/docs/1.0/tutorial/advanced#setting-request-configuration",children:"like shown here"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"autoload"})," - Load in file structure. Defaults to ",(0,s.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"api"})," - an API object."]}),"\n",(0,s.jsx)(n.li,{children:"All arguments supported by the API class (in case an API object is not provided)."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Temporary accounts aren't supported. Trying to login without an email or password will throw an error."}),"\n",(0,s.jsx)(n.h3,{id:"properties",children:"Properties"}),"\n",(0,s.jsxs)(n.p,{children:["Only loaded after ",(0,s.jsx)(n.code,{children:".resolve"}),", ",(0,s.jsx)(n.code,{children:"readyCallback()"})," or ",(0,s.jsx)(n.code,{children:"ready"})," event fires."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"name"})," - Account owner name"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"user"})," - Account ID"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"key"})," - Account master key"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sid"})," - Current session ID"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"files"})," - Hash of ",(0,s.jsx)(n.code,{children:"MutableFile"})," objects by node IDs."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"root"})," - ",(0,s.jsx)(n.code,{children:"MutableFile"})," object for Cloud Drive main directory"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"trash"})," - ",(0,s.jsx)(n.code,{children:"MutableFile"})," object for Rubbish bin"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"inbox"})," - ",(0,s.jsx)(n.code,{children:"MutableFile"})," object for Inbox"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"mounts"})," - Array of all top level directories"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"methods",children:"Methods"}),"\n",(0,s.jsx)(n.h4,{id:"shorthands",children:"Shorthands"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".upload"})," maps to ",(0,s.jsx)(n.code,{children:"storage.root.upload"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".mkdir"})," maps to ",(0,s.jsx)(n.code,{children:"storage.root.mkdir"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".find"})," maps to ",(0,s.jsx)(n.code,{children:"storage.root.find"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".filter"})," maps to ",(0,s.jsx)(n.code,{children:"storage.root.filter"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".navigate"})," maps to ",(0,s.jsx)(n.code,{children:"storage.root.navigate"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"reload",children:(0,s.jsx)(n.code,{children:".reload()"})}),"\n",(0,s.jsxs)(n.p,{children:["Reloads files tree. No need to call this if ",(0,s.jsx)(n.code,{children:"autoload"})," is used."]}),"\n",(0,s.jsx)(n.h4,{id:"login",children:(0,s.jsx)(n.code,{children:".login()"})}),"\n",(0,s.jsxs)(n.p,{children:["Logins to MEGA. No need to call this if ",(0,s.jsx)(n.code,{children:"autologin"})," is used."]}),"\n",(0,s.jsx)(n.h4,{id:"getaccountinfo",children:(0,s.jsx)(n.code,{children:".getAccountInfo()"})}),"\n",(0,s.jsx)(n.p,{children:"Get info related to account and quota usage. It returns a object with the following properties:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"type"}),": the account type"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"spaceUsed"}),": the space used by the account, in bytes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"spaceTotal"}),": the total space available, in bytes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"downloadBandwidthUsed"}),": the bandwidth quota used, in bytes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"downloadBandwidthTotal"}),": the total bandwidth quota available, in bytes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sharedBandwidthUsed"}),": the shared bandwidth quota used, in bytes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sharedBandwidthLimit"}),": the total shared bandwidth quota available, in bytes"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"close",children:(0,s.jsx)(n.code,{children:".close()"})}),"\n",(0,s.jsx)(n.p,{children:"Logs out MEGA and closes server-to-client connection. Other connections will not be closed. Attempting to call API requests after this point will result in errors."}),"\n",(0,s.jsx)(n.h3,{id:"events",children:"Events"}),"\n",(0,s.jsxs)(n.p,{children:["These events fire on file changes when ",(0,s.jsx)(n.code,{children:"keepalive"})," is used. The changes can be triggered from any session connected to the same account."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"add"})," - New file/dir was added. Parameters: file."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"move"})," - File was moved to another dir. Parameters: file, olddir."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"delete"})," - File was deleted. Parameters: file."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"update"})," - File was changed(renamed). Parameters: file."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"file",children:"File"}),"\n",(0,s.jsxs)(n.p,{children:["Basic class that handle files ",(0,s.jsx)(n.strong,{children:"and"})," folders. Often used to handle ",(0,s.jsx)(n.strong,{children:"shared"})," files and folders."]}),"\n",(0,s.jsx)(n.h3,{id:"creation-1",children:"Creation"}),"\n",(0,s.jsxs)(l.A,{groupId:"node2deno",children:[(0,s.jsx)(o.A,{value:"node_esm",label:"Node ESM",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import { File } from 'megajs'\nconst fileFromUrl = File.fromURL(url)\nconst fileFromObject = new File({ downloadId, key })\n"})})}),(0,s.jsx)(o.A,{value:"node_cjs",label:"Node CJS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const { File } = require('megajs')\nconst fileFromUrl = File.fromURL(url)\nconst fileFromObject = new File({ downloadId, key })\n"})})}),(0,s.jsx)(o.A,{value:"browser",label:"Browser",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import { File } from 'https://unpkg.com/megajs/dist/main.browser-es.mjs'\nconst fileFromUrl = File.fromURL(url)\nconst fileFromObject = new File({ downloadId, key })\n"})})}),(0,s.jsx)(o.A,{value:"deno",label:"Deno",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import { File } from 'npm:megajs'\nconst fileFromUrl = File.fromURL(url)\nconst fileFromObject = new File({ downloadId, key })\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:["To avoid collisions with ",(0,s.jsxs)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/File",children:["the global ",(0,s.jsx)(n.code,{children:"File"})," object"]})," you can use ",(0,s.jsx)(n.code,{children:"import { File as MEGAFile } from 'megajs'"})," or ",(0,s.jsx)(n.code,{children:"const { File: MEGAFile } = require('megajs')"})," and use ",(0,s.jsx)(n.code,{children:"MEGAFile"})," instead of ",(0,s.jsx)(n.code,{children:"File"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"options-1",children:"Options"}),"\n",(0,s.jsxs)(n.p,{children:["If a string is passed it needs to be a shared MEGA URL. It can be a ",(0,s.jsx)(n.code,{children:"https://mega.co.nz"})," or a ",(0,s.jsx)(n.code,{children:"https://mega.nz"})," file. The new URL format with ",(0,s.jsx)(n.code,{children:"/file/"})," or ",(0,s.jsx)(n.code,{children:"/folder/"})," is also supported."]}),"\n",(0,s.jsx)(n.p,{children:"If an object is passed it needs to have the options below:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"downloadId"}),": ",(0,s.jsx)(n.a,{href:"https://mega.nz/file/THIS_PART#...%60",children:"https://mega.nz/file/THIS_PART#...`"})," of the share link; a string."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"key"}),": ",(0,s.jsx)(n.code,{children:"https://mega.nz/file/...#THIS_PART"})," of the share link; string or a Buffer; optional."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"directory"}),": ",(0,s.jsx)(n.code,{children:"true"})," if loading a shared folder."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Both ",(0,s.jsx)(n.code,{children:"new File"})," and ",(0,s.jsx)(n.code,{children:"File.fromURL"})," supports receiving either an API object via ",(0,s.jsx)(n.code,{children:"api"})," argument like this:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const fileFromUrl = File.fromURL(url, { api })\nconst fileFromObject = new File({ downloadId, key, api })\n"})}),"\n",(0,s.jsxs)(n.p,{children:["This allows using an logged API object to increase download limits, as shown ",(0,s.jsx)(n.a,{href:"/docs/1.0/tutorial/network-settings",children:"here"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"properties-1",children:"Properties"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"name"})," - File name*"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"attributes"})," - Object of attributes*"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"size"})," - File size"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"key"})," - File key (buffer)*"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"timestamp"})," - File creation time (unix timestamp in seconds)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"nodeId"})," - File ID"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"downloadId"})," - Link ID to file. Only if created from link."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"directory"})," - Boolean if file is directory."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"children"})," - Array of files for directories."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Values marked with * are ",(0,s.jsx)(n.code,{children:"null"})," or ",(0,s.jsx)(n.code,{children:"undefined"})," when an encryption key isn't specified. An encryption key isn't specified when someone loads a shared file without specifying the encryption key like ",(0,s.jsx)(n.code,{children:"File.fromURL('https://mega.nz/file/something')"})," without the ",(0,s.jsx)(n.code,{children:"#random-string"})," part. Files loaded from accounts always have keys defined."]}),"\n",(0,s.jsx)(n.h3,{id:"methods-1",children:"Methods"}),"\n",(0,s.jsx)(n.h4,{id:"loadattributes",children:(0,s.jsx)(n.code,{children:".loadAttributes()"})}),"\n",(0,s.jsxs)(n.p,{children:["Load and decrypt file attributes. Attributes normally contain file name (",(0,s.jsx)(n.code,{children:"'n'"}),") but is possible to put anything there, as long it can be encoded as JSON. Isn't needed for files loaded from logged sessions. Trying to call it in a ",(0,s.jsx)(n.code,{children:"MutableFile"})," will throw an error."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"await file.loadAttributes()\nfile.loadAttributes((err, file) => { })\n"})}),"\n",(0,s.jsx)(n.p,{children:"This function can be also be used to load file information contained in shared folders."}),"\n",(0,s.jsx)(n.h4,{id:"downloadoptions-callback",children:(0,s.jsx)(n.code,{children:".download([options], [callback])"})}),"\n",(0,s.jsx)(n.p,{children:"Download and decrypt file contents into a readable stream or, if a callback is specified, into a buffer."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"file.download().pipe(fs.createWriteStream('myfile.txt'))\n\nfile.download((err, data) => {\n  // data is buffer\n})\n"})}),"\n",(0,s.jsx)(n.p,{children:"This function downloads files using chunked multiple parallel connections to speed up downloading. Similar to the MEGA implementation it first loads a 128KB chunk, then a 256KB, increasing it until it reaches 1MB. You can use the options below to control that."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"maxConnections"}),": the number of parallel connections is defined (default: 4);"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"initialChunkSize"}),": first chunk size, in bytes (default: 128KB);"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"chunkSizeIncrement"}),": how many bytes to increment each time (default: 128KB);"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"maxChunkSize"}),": maximum chunk size, in bytes (max 1MB);"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"returnCiphertext"}),": if ",(0,s.jsx)(n.code,{children:"true"})," the ciphertext will be returned, which can be decrypted later using ",(0,s.jsx)(n.code,{children:"decrypt"})," low level function."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"handleRetries"}),": accepts a function to handle retries on chunk downloading errors, overrides the function defined by ",(0,s.jsx)(n.code,{children:"File.defaultHandleRetries"}),";"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"forceHttps"}),": if set to ",(0,s.jsx)(n.code,{children:"true"})," will download using HTTPS, if set to ",(0,s.jsx)(n.code,{children:"false"})," will download using HTTP. Default to ",(0,s.jsx)(n.code,{children:"false"})," in the Node build and ",(0,s.jsx)(n.code,{children:"true"})," in the browser build. Should be set to ",(0,s.jsx)(n.code,{children:"false"})," in order to the library work in Deno."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["The download function also support ",(0,s.jsx)(n.code,{children:"start"})," and ",(0,s.jsx)(n.code,{children:"end"})," options, like ",(0,s.jsx)(n.a,{href:"https://nodejs.org/api/fs.html#fs_fs_createreadstream_path_options",children:(0,s.jsx)(n.code,{children:"fs.createReadStream"})}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Deno is not supported, but if you really want to use it then set ",(0,s.jsx)(n.code,{children:"forceHttps"})," to ",(0,s.jsx)(n.code,{children:"false"}),' otherwise Deno will block connections to MEGA servers. The reason is that MEGA use insecure TLS ciphers under the assumption their own crypto is enough, but Deno blocks that as it\'s "secure by default" and does not allow disabling this security layer unless you disable encryption entirely by setting ',(0,s.jsx)(n.code,{children:"forceHttps"})," to ",(0,s.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["If the number of connections get limited to ",(0,s.jsx)(n.code,{children:"1"})," then chunking will be disabled and the entire file will be downloaded using a single connection. For some reason doing this often results in less connection errors. At the moment this feature relies on a node-fetch extension and might not work in non-Node environments."]}),"\n",(0,s.jsxs)(n.p,{children:["You can get progress events from the ",(0,s.jsx)(n.code,{children:"progress"})," event which will contain the following properties:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"bytesLoaded"}),": the number of bytes loaded;"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"bytesTotal"}),": the total number of bytes of the file;"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"downloadbufferoptions",children:(0,s.jsx)(n.code,{children:".downloadBuffer([options])"})}),"\n",(0,s.jsxs)(n.p,{children:["Wraps the ",(0,s.jsx)(n.code,{children:".download()"})," function and return a Promise which resolves to a Buffer containing the file data. Accept the same options as ",(0,s.jsx)(n.code,{children:".download()"}),". It still accepts a callback, but then it's better to call ",(0,s.jsx)(n.code,{children:".download()"})," to avoid creating an unneeded promise."]}),"\n",(0,s.jsx)(n.h4,{id:"findquery-deep",children:(0,s.jsx)(n.code,{children:".find(query, [deep])"})}),"\n",(0,s.jsxs)(n.p,{children:["Search for files in directores, recursively if the deep argument is ",(0,s.jsx)(n.code,{children:"true"}),". Queries might be strings (which matches names, case sensitive), arrays of valid names (case sensitive) or a function which receives a File object as argument and should return a boolean."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Returns a file named `test.txt` inside the folder or undefined if no file gets found\nfolder.find('test.txt')\n\n// Returns a file named `test.txt` inside the folder while searching recursively\nfolder.find('test.txt', true)\n\n// Returns the first file with a size larger than 1024 bytes\nfolder.find(file => file.size > 1024)\n"})}),"\n",(0,s.jsx)(n.h4,{id:"filterquery-deep",children:(0,s.jsx)(n.code,{children:".filter(query, [deep])"})}),"\n",(0,s.jsxs)(n.p,{children:["Filters for files in directores, recursively if the deep argument is ",(0,s.jsx)(n.code,{children:"true"}),". Queries might be strings (which matches names, case sensitive), arrays of valid names (case sensitive) or a function which receives a File object as argument and should return a boolean."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Returns an array with all files named `test.txt` inside the folder\nfolder.filter('test.txt')\n\n// Returns an array with all files named `test.txt` while searching recursively\nfolder.filter('test.txt', true)\n\n// Returns an array with all files with a size larger than 1024 bytes\nfolder.filter(file => file.size > 1024)\n"})}),"\n",(0,s.jsx)(n.h4,{id:"navigatequery",children:(0,s.jsx)(n.code,{children:".navigate(query)"})}),"\n",(0,s.jsxs)(n.p,{children:["Tranverses directories. Query can be a string with a ",(0,s.jsx)(n.code,{children:"/"})," delimited path or an array of strings. Names are matched case sensitive."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Returns a file named `test.txt` inside \"some folder\"\nfolder.navigate('some folder/test.txt')\n\n// Paths can also be defined as arrays of strings\nfolder.navigate(['some folder', 'test.txt'])\n"})}),"\n",(0,s.jsx)(n.h3,{id:"static-methods",children:"Static methods"}),"\n",(0,s.jsx)(n.h4,{id:"filefromurlurl-options",children:(0,s.jsx)(n.code,{children:"File.fromURL(url, [options])"})}),"\n",(0,s.jsxs)(n.p,{children:["Creates a File object based on a shared file or folder URL. Accepts an optional options object with an ",(0,s.jsx)(n.code,{children:"api"})," object."]}),"\n",(0,s.jsx)(n.h4,{id:"filedefaulthandleretriestries-error-cb",children:(0,s.jsx)(n.code,{children:"File.defaultHandleRetries(tries, error, cb)"})}),"\n",(0,s.jsxs)(n.p,{children:["Default function used by ",(0,s.jsx)(n.code,{children:"File.protoype.download"})," and ",(0,s.jsx)(n.code,{children:"MutableFile.protoype.upload"})," to handle chunk downloading or upload should be retried on errors. Receives as arguments number of retries, the last error and a callback function."]}),"\n",(0,s.jsx)(n.p,{children:"This function can be overridden. Example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Default retry handler\nFile.defaultHandleRetries = (tries, error, cb) => {\n  if (tries > 8) {\n    cb(error)\n  } else {\n    setTimeout(cb, 1000 * Math.pow(2, tries))\n  }\n}\n\n// Restore behavior from V0\nFile.defaultHandleRetries = (tries, error, cb) => {\n  cb(error)\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"mutable-file",children:"Mutable File"}),"\n",(0,s.jsxs)(n.p,{children:["Represents files ",(0,s.jsx)(n.strong,{children:"and"})," folders that the current user can change in some way (like renaming). Extends ",(0,s.jsx)(n.code,{children:"File"})," adding methods that are only available when logged in."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Please note:"})," what are mutable are the attributes of the files and folders, ",(0,s.jsx)(n.strong,{children:"not"})," their contents, as this library don't support this yet."]}),"\n",(0,s.jsx)(n.h3,{id:"basic-syntax",children:"Basic syntax"}),"\n",(0,s.jsxs)(n.p,{children:["Those objects can be only accessed when logged in and can only be accessed via the ",(0,s.jsx)(n.code,{children:"Storage"})," object."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Returns the first file in the root of the storage\nstorage.root.children[0]\n\n// Returns a file named \"test.txt\" in the root of the storage\nstorage.find('test.txt')\n"})}),"\n",(0,s.jsx)(n.h3,{id:"methods-2",children:"Methods"}),"\n",(0,s.jsx)(n.h4,{id:"uploadoptions--name-data-callback",children:(0,s.jsx)(n.code,{children:".upload(options | name, [data], [callback])"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const uploadedFile = await folder.upload('myfile.txt', 'Hello world!').complete\nfs.createReadStream('myfile.txt').pipe(folder.upload('myfile.txt'))\nfolder.upload('myfile.txt', 'Hello world!', (error, uploadedFile) => {})\n"})}),"\n",(0,s.jsx)(n.p,{children:"Upload a file to a folder."}),"\n",(0,s.jsxs)(n.p,{children:["To input data you can input a buffer, string or stream in the data argument or, as it returns a ",(0,s.jsx)(n.a,{href:"https://nodejs.org/api/stream.html",children:"stream"}),", pipe data into it."]}),"\n",(0,s.jsx)(n.p,{children:"To handle upload completion or errors you can:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Await for the promise returned by ",(0,s.jsx)(n.code,{children:".complete"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Use the callback, which will return either an error as its first argument or the uploaded file instance as its second."}),"\n",(0,s.jsxs)(n.li,{children:["Listen for ",(0,s.jsx)(n.code,{children:"complete"})," and ",(0,s.jsx)(n.code,{children:"error"})," events."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Supported options:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"name"}),": file name, ",(0,s.jsx)(n.em,{children:(0,s.jsx)(n.strong,{children:"required"})})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"attributes"}),": object of file attributes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"key"}),": encryption key, Buffer or string; 192 bit; because MAC verification part of it be different in final key"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"size"}),": file size, ",(0,s.jsxs)(n.em,{children:[(0,s.jsx)(n.strong,{children:"required"})," unless ",(0,s.jsx)(n.code,{children:"allowUploadBuffering"})," is set to true"]}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"thumbnailImage"}),": the Buffer or Stream of the thumbnail image"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"previewImage"}),": the Buffer or Stream of the preview image"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"maxConnections"}),": the number of parallel connections is defined (default: 4);"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"initialChunkSize"}),": first chunk size, in bytes (default: 128KB);"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"chunkSizeIncrement"}),": how many bytes to increment each time (default: 128KB);"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"maxChunkSize"}),": maximum chunk size, in bytes (max 1MB);"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"handleRetries"}),": accepts a function to handle retries on chunk downloading errors, overrides the function defined by ",(0,s.jsx)(n.code,{children:"File.defaultHandleRetries"}),";"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"forceHttps"}),": if set to ",(0,s.jsx)(n.code,{children:"true"})," will upload using HTTPS, if set to ",(0,s.jsx)(n.code,{children:"false"})," will upload using HTTP. Default to ",(0,s.jsx)(n.code,{children:"false"})," in the Node build and ",(0,s.jsx)(n.code,{children:"true"})," in the browser build. Should be set to ",(0,s.jsx)(n.code,{children:"false"})," in order to the library work in Deno."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Deno is not supported, but if you really want to use it then set ",(0,s.jsx)(n.code,{children:"forceHttps"})," to ",(0,s.jsx)(n.code,{children:"false"}),' otherwise Deno will block connections to MEGA servers. The reason is that MEGA use insecure TLS ciphers under the assumption their own crypto is enough, but Deno blocks that as it\'s "secure by default" and does not allow disabling this security layer unless you disable encryption entirely by setting ',(0,s.jsx)(n.code,{children:"forceHttps"})," to ",(0,s.jsx)(n.code,{children:"false"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Thumbnail images are 120px x 120px JPEG images with 70% quality. Preview images are JPEG images with a maximum width and height size of 1000px and 75% quality. Please use those settings to avoid breaking compatibility with other MEGA clients. This library don't generates neither preview or thumbnail images, only provides a way to uploading those."}),"\n",(0,s.jsxs)(n.p,{children:["Uploading data without encryption is supported and ",(0,s.jsx)(n.a,{href:"/docs/1.0/tutorial/advanced#uploading-without-encryption",children:"is documented here"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["The upload stream is always returned even when a callback is specified. Standard events for ",(0,s.jsx)(n.a,{href:"https://nodejs.org/api/stream.html#stream_class_stream_writable",children:"Writable Streams"}),", like ",(0,s.jsx)(n.code,{children:"error"})," and ",(0,s.jsx)(n.code,{children:"finish"}),", and methods, like ",(0,s.jsx)(n.code,{children:".pipe()"})," and ",(0,s.jsx)(n.code,{children:".write()"}),", work normally."]}),"\n",(0,s.jsx)(n.h4,{id:"mkdiroptions--name",children:(0,s.jsx)(n.code,{children:".mkdir(options | name)"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"await folder.mkdir('dirname')\n"})}),"\n",(0,s.jsx)(n.p,{children:"Create a new folder inside the current folder."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Supported options:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"name"}),": directory name, ",(0,s.jsx)(n.em,{children:"required"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"attributes"}),": object of file attributes"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"key"}),": encryption key, Buffer or string; 128 bit; only used internally (when sharing folders other key is used)"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"importfilefile--url",children:(0,s.jsx)(n.code,{children:".importFile(File | URL)"})}),"\n",(0,s.jsxs)(n.p,{children:["Import a file to the specified folder. It accepts File objects (from ",(0,s.jsx)(n.code,{children:"new File"}),") or URLs of shared files."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Returns an instance of MutableFile\nconst file = await folder.importFile('https://mega.nz/#!...')\n"})}),"\n",(0,s.jsxs)(n.h4,{id:"linkoptions--sharefolderoptions",children:[(0,s.jsx)(n.code,{children:".link([options])"})," / ",(0,s.jsx)(n.code,{children:".shareFolder([options])"})]}),"\n",(0,s.jsxs)(n.p,{children:["Make download link for a file or folder. ",(0,s.jsx)(n.code,{children:".shareFolder"})," only works for folders, ",(0,s.jsx)(n.code,{children:".link"})," works for both (but calls ",(0,s.jsx)(n.code,{children:".shareFolder"})," internally)."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Returns something like https://mega.nz/#!downloadId!key\nconst url = await file.link()\n"})}),"\n",(0,s.jsx)(n.p,{children:"Supported options:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"noKey"}),": set ",(0,s.jsx)(n.code,{children:"true"})," to return a url without an encryption key"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"key"}),": only works for folders, encryption key, can be a string or buffer, 128 bit"]}),"\n"]}),"\n",(0,s.jsxs)(n.h4,{id:"unshare--unsharefolder",children:[(0,s.jsx)(n.code,{children:".unshare()"})," / ",(0,s.jsx)(n.code,{children:".unshareFolder()"})]}),"\n",(0,s.jsxs)(n.p,{children:["Unshares files and folders. ",(0,s.jsx)(n.code,{children:".unshareFolder"})," only works for folders, ",(0,s.jsx)(n.code,{children:".unshare"})," works for both (but calls ",(0,s.jsx)(n.code,{children:".unshareFolder"})," internally)."]}),"\n",(0,s.jsx)(n.h4,{id:"deletepermanent",children:(0,s.jsx)(n.code,{children:".delete(permanent)"})}),"\n",(0,s.jsxs)(n.p,{children:["Delete file, permanently if ",(0,s.jsx)(n.code,{children:"permanent"})," is true, otherwise file is moved to rubbish bin."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Moves the file to rubbish bin\nawait file.delete()\n\n// Deletes the file permanently\nawait file.delete(true)\n"})}),"\n",(0,s.jsx)(n.h4,{id:"movetotarget",children:(0,s.jsx)(n.code,{children:".moveTo(target)"})}),"\n",(0,s.jsx)(n.p,{children:"Move a file to target, which can be a folder object or it's nodeId."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"// Moves the file to storage root\nawait file.moveTo(storage.root)\n"})}),"\n",(0,s.jsx)(n.h4,{id:"setattributesattributes",children:(0,s.jsx)(n.code,{children:".setAttributes(attributes)"})}),"\n",(0,s.jsx)(n.p,{children:"Set the the attributes of a object. Doesn't remove the current ones, but can overwrite those."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"await file.setAttributes({someAttribute: someValue})\n"})}),"\n",(0,s.jsx)(n.h4,{id:"uploadattributetype-bufferstream",children:(0,s.jsx)(n.code,{children:".uploadAttribute(type, [buffer|stream])"})}),"\n",(0,s.jsx)(n.p,{children:"Upload a thumbnail or preview image to the existent file. Fails if the node is a folder."}),"\n",(0,s.jsxs)(n.p,{children:["The argument ",(0,s.jsx)(n.code,{children:"type"})," can be a string (",(0,s.jsx)(n.code,{children:"thumbnail"})," or ",(0,s.jsx)(n.code,{children:"preview"}),") or a integer (",(0,s.jsx)(n.code,{children:"0"})," and ",(0,s.jsx)(n.code,{children:"1"}),")."]}),"\n",(0,s.jsx)(n.h4,{id:"renamenewfilename",children:(0,s.jsx)(n.code,{children:".rename(newFileName)"})}),"\n",(0,s.jsx)(n.p,{children:"Rename a file."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"await file.rename('hello-world.txt')\n"})}),"\n",(0,s.jsx)(n.h4,{id:"setlabellabel",children:(0,s.jsx)(n.code,{children:".setLabel(label)"})}),"\n",(0,s.jsxs)(n.p,{children:["Set file's label, where ",(0,s.jsx)(n.code,{children:"label"})," can be a number between 0 and 7 or a valid label color the following: 'red', 'orange', 'yellow', 'green', 'blue', 'purple' and 'grey'."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"await file.setLabel('red')\n"})}),"\n",(0,s.jsx)(n.h4,{id:"setfavoriteisfavorite",children:(0,s.jsx)(n.code,{children:".setFavorite(isFavorite)"})}),"\n",(0,s.jsxs)(n.p,{children:["Set file as favorite is ",(0,s.jsx)(n.code,{children:"isFavorite"})," is ",(0,s.jsx)(n.code,{children:"true"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"await file.setFavorite(true)\nawait file.setFavorite(false)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"events-1",children:"Events"}),"\n",(0,s.jsx)(n.p,{children:"Same events as for Storage objects. Only trigger for a specific file."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"move"})," - File was moved to another dir. Parameters: olddir."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"delete"})," - File was deleted."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"update"})," - File metadata was changed."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"api",children:"API"}),"\n",(0,s.jsx)(n.p,{children:"The API class handles API connections, which includes part of the logged state, user-agent, HTTP/HTTPS agents (for proxying)."}),"\n",(0,s.jsx)(n.h3,{id:"properties-2",children:"Properties"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"gateway"})," - the gateway used to connect to MEGA's API, defaults to ",(0,s.jsx)(n.code,{children:"https://g.api.mega.co.nz/"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"userAgent"})," - the user-agent used when connecting."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"httpAgent"})," and ",(0,s.jsx)(n.code,{children:"httpsAgent"})," - the HTTP(S) agents used in Node, can be overriden to enable proxying;"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"fetch"})," - the fetch function used by library, defaults to ",(0,s.jsx)(n.code,{children:"node-fetch"})," in Node and ",(0,s.jsx)(n.code,{children:"globalThis.fetch"})," in other environments;"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["If the ",(0,s.jsx)(n.code,{children:"fetch"})," function is overridden then the ",(0,s.jsx)(n.code,{children:"userAgent"}),", httpAgent",(0,s.jsx)(n.code,{children:"and"}),"httpsAgent` properties will be ignored."]}),"\n",(0,s.jsxs)(n.p,{children:["It is recommended to set up an user-agent. The library will default to ",(0,s.jsx)(n.code,{children:"megajs/{version}"})," (where ",(0,s.jsx)(n.code,{children:"{version}"})," is the library version). When deploying to browsers set ",(0,s.jsx)(n.code,{children:"userAgent"})," to ",(0,s.jsx)(n.code,{children:"null"})," as it can cause issues in some browsers which allow client-side code to override the ",(0,s.jsx)(n.code,{children:"user-agent"})," header (i.e. Firefox)."]}),"\n",(0,s.jsx)(n.h3,{id:"static-functions",children:"Static functions"}),"\n",(0,s.jsx)(n.h4,{id:"apigetglobalapi",children:(0,s.jsx)(n.code,{children:"API.getGlobalApi()"})}),"\n",(0,s.jsxs)(n.p,{children:["Returns the global API shared by ",(0,s.jsx)(n.code,{children:"File"})," instances."]}),"\n",(0,s.jsxs)(l.A,{groupId:"node2deno",children:[(0,s.jsx)(o.A,{value:"node_esm",label:"Node ESM",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import { API } from 'megajs'\nconst api = API.getGlobalApi()\n"})})}),(0,s.jsx)(o.A,{value:"node_cjs",label:"Node CJS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const { API } = require('megajs')\nconst api = API.getGlobalApi()\n"})})}),(0,s.jsx)(o.A,{value:"browser",label:"Browser",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import { API } from 'https://unpkg.com/megajs/dist/main.browser-es.mjs'\nconst api = API.getGlobalApi()\n"})})}),(0,s.jsx)(o.A,{value:"deno",label:"Deno",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import { API } from 'npm:megajs'\nconst api = API.getGlobalApi()\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:["Storage objects have their own API objects which can be accessed via ",(0,s.jsx)(n.code,{children:"storage.api"}),". The API objects of File objects can be accessed via ",(0,s.jsx)(n.code,{children:"file.api"})," and default to the global instance, but can be overridden to an API instance from a Storage to allow using account downloading limits."]}),"\n",(0,s.jsx)(n.h2,{id:"low-level-functions",children:"Low level functions"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"verify"})," function accept a file key as argument creates a PassThrough stream that verifies the content received against the key."]}),"\n",(0,s.jsxs)(l.A,{groupId:"node2deno",children:[(0,s.jsx)(o.A,{value:"node_esm",label:"Node ESM",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import { verify } from 'megajs'\n\nconst fileKey = 'example-file-key'\nconst verifyFunction = verify(fileKey)\nconst fileStream = getFileStreamSomehow()\nfileStream.pipe(verifyFunction)\n\nverifyFunction.on('end', () => console.log('File is valid'))\nverifyFunction.on('error', () => console.log('File is corrupted'))\n"})})}),(0,s.jsx)(o.A,{value:"node_cjs",label:"Node CJS",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"const { verify } = require('megajs')\n\nconst fileKey = 'example-file-key'\nconst verifyFunction = verify(fileKey)\nconst fileStream = getFileStreamSomehow()\nfileStream.pipe(verifyFunction)\n\nverifyFunction.on('end', () => console.log('File is valid'))\nverifyFunction.on('error', () => console.log('File is corrupted'))\n"})})}),(0,s.jsx)(o.A,{value:"browser",label:"Browser",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import { verify } from 'https://unpkg.com/megajs/dist/main.browser-es.mjs'\n\nconst fileKey = 'example-file-key'\nconst verifyFunction = verify(fileKey)\nconst fileStream = getFileStreamSomehow()\nfileStream.pipe(verifyFunction)\n\nverifyFunction.on('end', () => console.log('File is valid'))\nverifyFunction.on('error', () => console.log('File is corrupted'))\n"})})}),(0,s.jsx)(o.A,{value:"deno",label:"Deno",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"import { verify } from 'npm:megajs'\n\nconst fileKey = 'example-file-key'\nconst verifyFunction = verify(fileKey)\nconst fileStream = getFileStreamSomehow()\nfileStream.pipe(verifyFunction)\n\nverifyFunction.on('end', () => console.log('File is valid'))\nverifyFunction.on('error', () => console.log('File is corrupted'))\n"})})})]}),"\n",(0,s.jsxs)(n.p,{children:["The file key follows the same rules as the ",(0,s.jsx)(n.code,{children:"key"})," argument in the ",(0,s.jsx)(n.code,{children:"File"})," constructor, so it can be a string (",(0,s.jsx)(n.code,{children:"https://mega.nz/file/...#THIS_PART_OF_THE_SHARE_LINK"}),"), a Buffer or a Uint8Array."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"encrypt"})," and ",(0,s.jsx)(n.code,{children:"decrypt"})," are lower level transform streams. They accept a key as input and transform file data and outputs encrypted data and vice versa. They also handle MAC verification / generation."]}),"\n",(0,s.jsxs)(n.p,{children:["The key for ",(0,s.jsx)(n.code,{children:"encrypt"})," must be 192 bit. When the stream ends it a full 256 bit key will be available via the ",(0,s.jsx)(n.code,{children:".key"})," property. The additional 64 bit come from the MAC."]}),"\n",(0,s.jsxs)(n.p,{children:["The key for the ",(0,s.jsx)(n.code,{children:"decrypt"})," function must be the same 256 bit key returned during encryption."]}),"\n",(0,s.jsxs)(n.p,{children:["Those two functions are almost never used as ",(0,s.jsx)(n.code,{children:"download"})," and ",(0,s.jsx)(n.code,{children:"upload"})," already handle encryption. They are only exported in order to allow backyards compatibility."]})]})}function j(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},9365:(e,n,i)=>{i.d(n,{A:()=>o});i(6540);var s=i(4164);const r={tabItem:"tabItem_Ymn6"};var l=i(4848);function o(e){let{children:n,hidden:i,className:o}=e;return(0,l.jsx)("div",{role:"tabpanel",className:(0,s.A)(r.tabItem,o),hidden:i,children:n})}},1470:(e,n,i)=>{i.d(n,{A:()=>w});var s=i(6540),r=i(4164),l=i(3104),o=i(6347),t=i(205),d=i(7485),a=i(1682),c=i(9466);function h(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:n,children:i}=e;return(0,s.useMemo)((()=>{const e=n??function(e){return h(e).map((e=>{let{props:{value:n,label:i,attributes:s,default:r}}=e;return{value:n,label:i,attributes:s,default:r}}))}(i);return function(e){const n=(0,a.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,i])}function j(e){let{value:n,tabValues:i}=e;return i.some((e=>e.value===n))}function x(e){let{queryString:n=!1,groupId:i}=e;const r=(0,o.W6)(),l=function(e){let{queryString:n=!1,groupId:i}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!i)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return i??null}({queryString:n,groupId:i});return[(0,d.aZ)(l),(0,s.useCallback)((e=>{if(!l)return;const n=new URLSearchParams(r.location.search);n.set(l,e),r.replace({...r.location,search:n.toString()})}),[l,r])]}function f(e){const{defaultValue:n,queryString:i=!1,groupId:r}=e,l=u(e),[o,d]=(0,s.useState)((()=>function(e){let{defaultValue:n,tabValues:i}=e;if(0===i.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!j({value:n,tabValues:i}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${i.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const s=i.find((e=>e.default))??i[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:l}))),[a,h]=x({queryString:i,groupId:r}),[f,p]=function(e){let{groupId:n}=e;const i=function(e){return e?`docusaurus.tab.${e}`:null}(n),[r,l]=(0,c.Dv)(i);return[r,(0,s.useCallback)((e=>{i&&l.set(e)}),[i,l])]}({groupId:r}),m=(()=>{const e=a??f;return j({value:e,tabValues:l})?e:null})();(0,t.A)((()=>{m&&d(m)}),[m]);return{selectedValue:o,selectValue:(0,s.useCallback)((e=>{if(!j({value:e,tabValues:l}))throw new Error(`Can't select invalid tab value=${e}`);d(e),h(e),p(e)}),[h,p,l]),tabValues:l}}var p=i(2303);const m={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var g=i(4848);function b(e){let{className:n,block:i,selectedValue:s,selectValue:o,tabValues:t}=e;const d=[],{blockElementScrollPositionUntilNextRender:a}=(0,l.a_)(),c=e=>{const n=e.currentTarget,i=d.indexOf(n),r=t[i].value;r!==s&&(a(n),o(r))},h=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const i=d.indexOf(e.currentTarget)+1;n=d[i]??d[0];break}case"ArrowLeft":{const i=d.indexOf(e.currentTarget)-1;n=d[i]??d[d.length-1];break}}n?.focus()};return(0,g.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":i},n),children:t.map((e=>{let{value:n,label:i,attributes:l}=e;return(0,g.jsx)("li",{role:"tab",tabIndex:s===n?0:-1,"aria-selected":s===n,ref:e=>d.push(e),onKeyDown:h,onClick:c,...l,className:(0,r.A)("tabs__item",m.tabItem,l?.className,{"tabs__item--active":s===n}),children:i??n},n)}))})}function v(e){let{lazy:n,children:i,selectedValue:r}=e;const l=(Array.isArray(i)?i:[i]).filter(Boolean);if(n){const e=l.find((e=>e.props.value===r));return e?(0,s.cloneElement)(e,{className:"margin-top--md"}):null}return(0,g.jsx)("div",{className:"margin-top--md",children:l.map(((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==r})))})}function y(e){const n=f(e);return(0,g.jsxs)("div",{className:(0,r.A)("tabs-container",m.tabList),children:[(0,g.jsx)(b,{...n,...e}),(0,g.jsx)(v,{...n,...e})]})}function w(e){const n=(0,p.A)();return(0,g.jsx)(y,{...e,children:h(e.children)},String(n))}}}]);